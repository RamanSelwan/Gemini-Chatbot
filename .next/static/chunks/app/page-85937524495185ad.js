(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{2887:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>P});var s=r(5155),a=r(2115);let l={USER:"gemini_chat_user",CHATROOMS:"gemini_chat_chatrooms",THEME:"gemini_chat_theme"},n={getUser:()=>{let e=localStorage.getItem(l.USER);return e?JSON.parse(e):null},setUser:e=>{localStorage.setItem(l.USER,JSON.stringify(e))},removeUser:()=>{localStorage.removeItem(l.USER)},getChatrooms:()=>{let e=localStorage.getItem(l.CHATROOMS);return e?JSON.parse(e):[]},setChatrooms:e=>{localStorage.setItem(l.CHATROOMS,JSON.stringify(e))},getTheme:()=>"dark"===localStorage.getItem(l.THEME)?"dark":"light",setTheme:e=>{localStorage.setItem(l.THEME,e)}};function i(){let[e,t]=(0,a.useState)(null),[r,s]=(0,a.useState)(!0);return(0,a.useEffect)(()=>{t(n.getUser()),s(!1)},[]),{user:e,isLoading:r,login:e=>{t(e),n.setUser(e)},logout:()=>{t(null),n.removeUser()}}}var o=r(2177),c=r(221),d=r(927);let m=d.Ik({countryCode:d.Yj().min(1,"Please select a country"),phone:d.Yj().min(6,"Phone number must be at least 6 digits").max(15,"Phone number must be at most 15 digits").regex(/^\d+$/,"Phone number must contain only digits")}),u=d.Ik({otp:d.Yj().length(6,"OTP must be exactly 6 digits").regex(/^\d+$/,"OTP must contain only digits")}),x=d.Ik({title:d.Yj().min(1,"Chatroom title is required").max(50,"Title must be at most 50 characters")});var g=r(2596);function h(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,g.$)(t)}function y(){return Math.random().toString(36).substr(2,9)}function f(e){return new Intl.DateTimeFormat("en-US",{hour:"2-digit",minute:"2-digit",hour12:!0}).format(e)}let p=(0,a.forwardRef)((e,t)=>{let{className:r,variant:a="primary",size:l="md",isLoading:n,children:i,disabled:o,...c}=e;return(0,s.jsxs)("button",{ref:t,className:h("inline-flex items-center justify-center rounded-lg font-medium transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 disabled:pointer-events-none whitespace-nowrap cursor-pointer",{primary:"bg-blue-600 text-white hover:bg-blue-700 focus:ring-blue-500",secondary:"bg-gray-200 dark:bg-gray-700 text-gray-900 dark:text-gray-100 hover:bg-gray-300 dark:hover:bg-gray-600 focus:ring-gray-500",ghost:"text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 focus:ring-gray-500",danger:"bg-red-600 text-white hover:bg-red-700 focus:ring-red-500"}[a],{sm:"px-3 py-1.5 text-sm",md:"px-4 py-2 text-sm",lg:"px-6 py-3 text-base"}[l],r),disabled:o||n,...c,children:[n&&(0,s.jsx)("div",{className:"w-4 h-4 mr-2 animate-spin rounded-full border-2 border-transparent border-t-current"}),i]})});p.displayName="Button";let b=(0,a.forwardRef)((e,t)=>{let{className:r,type:a,error:l,...n}=e;return(0,s.jsxs)("div",{className:"w-full",children:[(0,s.jsx)("input",{type:a,className:h("flex h-10 w-full rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 px-3 py-2 text-sm text-gray-900 dark:text-gray-100 placeholder:text-gray-500 dark:placeholder:text-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:cursor-not-allowed disabled:opacity-50",l&&"border-red-500 focus:ring-red-500",r),ref:t,...n}),l&&(0,s.jsx)("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:l})]})});b.displayName="Input";var j=r(3568);function v(e){var t;let{onOtpSent:r}=e,[l,n]=(0,a.useState)(!1),[i,d]=(0,a.useState)(!1),[u,x]=(0,a.useState)(""),{countries:g,isLoading:h}=function(){let[e,t]=(0,a.useState)([]),[r,s]=(0,a.useState)(!0),[l,n]=(0,a.useState)(null);return(0,a.useEffect)(()=>{(async()=>{try{let e=await fetch("https://restcountries.com/v3.1/all?fields=name,cca2,idd,flag");if(!e.ok)throw Error("Failed to fetch countries");let r=(await e.json()).filter(e=>{var t,r;return(null==(t=e.idd)?void 0:t.root)&&(null==(r=e.idd)?void 0:r.suffixes)}).sort((e,t)=>e.name.common.localeCompare(t.name.common));t(r)}catch(e){n(e instanceof Error?e.message:"Failed to fetch countries")}finally{s(!1)}})()},[]),{countries:e,isLoading:r,error:l}}(),{register:y,handleSubmit:f,formState:{errors:v},setValue:N,watch:k}=(0,o.mN)({resolver:(0,c.u)(m),defaultValues:{phone:"",countryCode:""}}),w=k("countryCode")||"",C=async e=>{n(!0),setTimeout(()=>{j.Ay.success("OTP sent successfully!"),r(e.phone,e.countryCode),n(!1)},1500)},S=e=>{var t;let r=e.idd.root+((null==(t=e.idd.suffixes)?void 0:t[0])||"");N("countryCode",r),x("".concat(e.flag," ").concat(e.name.common," (").concat(r,")")),d(!1)};return(0,s.jsxs)("div",{className:"w-full max-w-md mx-auto bg-white dark:bg-gray-800 rounded-lg shadow-lg p-8",children:[(0,s.jsxs)("div",{className:"text-center mb-8",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100 mb-2",children:"Welcome to Gemini Chat"}),(0,s.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:"Enter your phone number to get started"})]}),(0,s.jsxs)("form",{onSubmit:f(C),className:"space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Country"}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsxs)("button",{type:"button",onClick:()=>d(!i),className:"w-full flex items-center justify-between px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 text-left text-sm text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,s.jsx)("span",{children:u||"Select country"}),(0,s.jsx)("i",{className:"ri-arrow-down-s-line text-gray-400"})]}),i&&(0,s.jsx)("div",{className:"absolute z-10 w-full mt-1 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-md shadow-lg max-h-60 overflow-y-auto",children:h?(0,s.jsx)("div",{className:"p-4 text-center text-gray-500",children:"Loading..."}):g.map(e=>{var t;return(0,s.jsxs)("button",{type:"button",onClick:()=>S(e),className:"w-full px-3 py-2 text-left hover:bg-gray-100 dark:hover:bg-gray-700 text-sm text-gray-900 dark:text-gray-100 flex items-center space-x-2",children:[(0,s.jsx)("span",{children:e.flag}),(0,s.jsx)("span",{children:e.name.common}),(0,s.jsxs)("span",{className:"text-gray-500",children:["(",e.idd.root,null==(t=e.idd.suffixes)?void 0:t[0],")"]})]},e.cca2)})})]}),v.countryCode&&(0,s.jsx)("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:v.countryCode.message}),(0,s.jsx)("input",{type:"hidden",...y("countryCode")})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Phone Number"}),(0,s.jsxs)("div",{className:"flex space-x-2",children:[(0,s.jsx)("div",{className:"w-20",children:(0,s.jsx)(b,{value:w,readOnly:!0,className:"text-center",placeholder:"+1"})}),(0,s.jsx)("div",{className:"flex-1",children:(0,s.jsx)(b,{...y("phone"),type:"tel",placeholder:"123456789",error:null==(t=v.phone)?void 0:t.message})})]})]}),(0,s.jsx)(p,{type:"submit",isLoading:l,className:"w-full",size:"lg",children:"Send OTP"})]})]})}function N(e){let{phone:t,countryCode:r,onVerify:l,onBack:n}=e,[i,d]=(0,a.useState)(!1),[m,x]=(0,a.useState)(["","","","","",""]),[g,h]=(0,a.useState)(30),y=(0,a.useRef)([]),{handleSubmit:f,formState:{errors:b},setValue:v}=(0,o.mN)({resolver:(0,c.u)(u)});(0,a.useEffect)(()=>{let e=g>0?setInterval(()=>{h(e=>e-1)},1e3):null;return()=>{e&&clearInterval(e)}},[g]);let N=(e,t)=>{if(t.length>1)return;let r=[...m];if(r[e]=t,x(r),v("otp",r.join("")),t&&e<5){var s;null==(s=y.current[e+1])||s.focus()}},k=(e,t)=>{if("Backspace"===t.key&&!m[e]&&e>0){var r;null==(r=y.current[e-1])||r.focus()}},w=async()=>{let e=m.join("");if(6!==e.length)return void j.Ay.error("Please enter complete OTP");d(!0),setTimeout(()=>{"123456"===e?(j.Ay.success("Phone verified successfully!"),l()):j.Ay.error("Invalid OTP. Try 123456 for demo."),d(!1)},1500)};return(0,s.jsxs)("div",{className:"w-full max-w-md mx-auto bg-white dark:bg-gray-800 rounded-lg shadow-lg p-8",children:[(0,s.jsxs)("div",{className:"text-center mb-8",children:[(0,s.jsx)("button",{onClick:n,className:"absolute top-4 left-4 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:(0,s.jsx)("i",{className:"ri-arrow-left-line text-xl"})}),(0,s.jsx)("h1",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100 mb-2",children:"Verify Phone"}),(0,s.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:"Enter the 6-digit code sent to"}),(0,s.jsxs)("p",{className:"text-blue-600 dark:text-blue-400 font-medium",children:[r," ",t]}),(0,s.jsx)("p",{className:"text-xs text-gray-500 mt-2",children:"Use 123456 for demo"})]}),(0,s.jsxs)("form",{onSubmit:f(w),className:"space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-4 text-center",children:"Enter OTP"}),(0,s.jsx)("div",{className:"flex justify-center space-x-2",children:m.map((e,t)=>(0,s.jsx)("input",{ref:e=>y.current[t]=e,type:"text",inputMode:"numeric",maxLength:1,value:e,onChange:e=>N(t,e.target.value),onKeyDown:e=>k(t,e),className:"w-12 h-12 text-center text-lg font-semibold border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"},t))}),b.otp&&(0,s.jsx)("p",{className:"mt-2 text-sm text-red-600 dark:text-red-400 text-center",children:b.otp.message})]}),(0,s.jsx)(p,{type:"submit",isLoading:i,className:"w-full",size:"lg",children:"Verify OTP"}),(0,s.jsx)("div",{className:"text-center",children:g>0?(0,s.jsxs)("p",{className:"text-sm text-gray-500",children:["Resend OTP in ",g,"s"]}):(0,s.jsx)("button",{type:"button",onClick:()=>{h(30),j.Ay.success("OTP sent again!")},className:"text-sm text-blue-600 dark:text-blue-400 hover:underline cursor-pointer",children:"Resend OTP"})})]})]})}var k=r(1362),w=r(5695);function C(){let e=(0,w.useRouter)(),{theme:t,setTheme:r}=(0,k.D)(),{user:a,logout:l}=i();return(0,s.jsx)("header",{className:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 px-6 py-4",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("div",{className:"flex items-center space-x-4",children:(0,s.jsx)("h1",{className:"text-xl font-bold text-gray-900 dark:text-gray-100 font-pacifico",children:"Gemini Chat"})}),(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,s.jsx)("button",{onClick:()=>r("light"===t?"dark":"light"),className:"p-2 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 transition-colors cursor-pointer",title:"Switch to ".concat("light"===t?"dark":"light"," mode"),children:(0,s.jsx)("i",{className:"ri-".concat("light"===t?"moon":"sun","-line text-xl")})}),a&&(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsx)("div",{className:"text-sm",children:(0,s.jsxs)("p",{className:"text-gray-900 dark:text-gray-100 font-medium",children:[a.countryCode," ",a.phone]})}),(0,s.jsxs)(p,{onClick:()=>{l(),e.push("/")},variant:"ghost",size:"sm",className:"text-red-600 hover:text-red-700 hover:bg-red-50 dark:hover:bg-red-900/20",children:[(0,s.jsx)("i",{className:"ri-logout-circle-line mr-2"}),"Logout"]})]})]})]})})}function S(e){let{chatrooms:t,currentChatroom:r,onSelectChatroom:l,onDeleteChatroom:n,onCreateChatroom:i}=e,[o,c]=(0,a.useState)(""),d=(0,a.useMemo)(()=>{var e;let t;return e=e=>c(e),function(){for(var r=arguments.length,s=Array(r),a=0;a<r;a++)s[a]=arguments[a];clearTimeout(t),t=setTimeout(()=>e(...s),300)}},[]),m=(0,a.useMemo)(()=>t.filter(e=>e.title.toLowerCase().includes(o.toLowerCase())),[t,o]);return(0,s.jsxs)("div",{className:"w-80 bg-white dark:bg-gray-800 border-r border-gray-200 dark:border-gray-700 flex flex-col",children:[(0,s.jsxs)("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:"Chats"}),(0,s.jsx)(p,{onClick:i,size:"sm",className:"w-8 h-8 p-0 flex items-center justify-center",children:(0,s.jsx)("i",{className:"ri-add-line text-lg"})})]}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(b,{placeholder:"Search chats...",onChange:e=>d(e.target.value),className:"pl-10"}),(0,s.jsx)("i",{className:"ri-search-line absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 text-sm"})]})]}),(0,s.jsx)("div",{className:"flex-1 overflow-y-auto",children:0===m.length?(0,s.jsxs)("div",{className:"p-8 text-center",children:[(0,s.jsx)("i",{className:"ri-chat-3-line text-4xl text-gray-400 mb-4"}),(0,s.jsx)("p",{className:"text-gray-500 dark:text-gray-400",children:o?"No chats found":"No chats yet"}),!o&&(0,s.jsx)(p,{onClick:i,size:"sm",className:"mt-4",children:"Start a chat"})]}):(0,s.jsx)("div",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:m.map(e=>(0,s.jsx)("div",{className:"p-4 hover:bg-gray-50 dark:hover:bg-gray-700 cursor-pointer transition-colors group ".concat(r===e.id?"bg-blue-50 dark:bg-blue-900/20":""),onClick:()=>l(e.id),children:(0,s.jsx)("div",{className:"flex items-center justify-between",children:(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,s.jsx)("h3",{className:"text-sm font-medium text-gray-900 dark:text-gray-100 truncate",children:e.title}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[e.lastMessage&&(0,s.jsx)("span",{className:"text-xs text-gray-500",children:f(new Date(e.lastMessage.timestamp))}),(0,s.jsx)("button",{onClick:t=>{t.stopPropagation(),n(e.id)},className:"opacity-0 group-hover:opacity-100 text-gray-400 hover:text-red-500 transition-all cursor-pointer",children:(0,s.jsx)("i",{className:"ri-delete-bin-line text-sm"})})]})]}),e.lastMessage&&(0,s.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400 truncate",children:"image"===e.lastMessage.type?"\uD83D\uDCF7 Image":e.lastMessage.content})]})})},e.id))})})]})}function T(e){let{messages:t,isTyping:r,onLoadMore:l,hasMore:n,isLoading:i}=e,o=(0,a.useRef)(null),c=(0,a.useRef)(null),[d,m]=(0,a.useState)(!1);(0,a.useEffect)(()=>{u()},[t,r]),(0,a.useEffect)(()=>{let e=()=>{if(!c.current)return;let{scrollTop:e,scrollHeight:r,clientHeight:s}=c.current;m(!(r-e-s<100)&&t.length>0),0===e&&n&&!i&&l()},r=c.current;if(r)return r.addEventListener("scroll",e),()=>r.removeEventListener("scroll",e)},[n,i,t.length,l]);let u=()=>{var e;null==(e=o.current)||e.scrollIntoView({behavior:"smooth"})},x=async e=>{try{await function(e){if(navigator.clipboard&&window.isSecureContext)return navigator.clipboard.writeText(e);{let t=document.createElement("textarea");return t.value=e,t.style.position="fixed",t.style.left="-999999px",t.style.top="-999999px",document.body.appendChild(t),t.focus(),t.select(),new Promise((e,r)=>{document.execCommand("copy")?(t.remove(),e()):(t.remove(),r())})}}(e),j.Ay.success("Message copied to clipboard")}catch(e){j.Ay.error("Failed to copy message")}};return 0!==t.length||i?(0,s.jsxs)("div",{className:"flex-1 relative",children:[(0,s.jsxs)("div",{ref:c,className:"h-full overflow-y-auto p-4 space-y-4",children:[i&&(0,s.jsx)("div",{className:"flex justify-center py-4",children:(0,s.jsxs)("div",{className:"flex items-center space-x-2 text-gray-500",children:[(0,s.jsx)("div",{className:"w-4 h-4 animate-spin rounded-full border-2 border-transparent border-t-gray-500"}),(0,s.jsx)("span",{className:"text-sm",children:"Loading messages..."})]})}),t.map(e=>(0,s.jsx)("div",{className:"flex ".concat("user"===e.sender?"justify-end":"justify-start"),children:(0,s.jsxs)("div",{className:"group max-w-xs lg:max-w-md relative ".concat("user"===e.sender?"ml-12":"mr-12"),children:[(0,s.jsx)("div",{className:"rounded-lg p-3 shadow-sm ".concat("user"===e.sender?"bg-blue-600 text-white":"bg-gray-100 dark:bg-gray-700 text-gray-900 dark:text-gray-100"),children:"image"===e.type&&e.imageUrl?(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("img",{src:e.imageUrl,alt:"Shared image",className:"rounded-lg max-w-full h-auto"}),e.content&&(0,s.jsx)("p",{className:"text-sm",children:e.content})]}):(0,s.jsx)("p",{className:"text-sm whitespace-pre-wrap",children:e.content})}),(0,s.jsxs)("div",{className:"flex items-center mt-1 space-x-2 ".concat("user"===e.sender?"justify-end":"justify-start"),children:[(0,s.jsx)("span",{className:"text-xs text-gray-500",children:f(new Date(e.timestamp))}),(0,s.jsx)("button",{onClick:()=>x(e.content),className:"opacity-0 group-hover:opacity-100 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-opacity cursor-pointer",title:"Copy message",children:(0,s.jsx)("i",{className:"ri-file-copy-line text-xs"})})]})]})},e.id)),r&&(0,s.jsx)("div",{className:"flex justify-start",children:(0,s.jsx)("div",{className:"mr-12",children:(0,s.jsx)("div",{className:"bg-gray-100 dark:bg-gray-700 rounded-lg p-3",children:(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsxs)("div",{className:"flex space-x-1",children:[(0,s.jsx)("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce"}),(0,s.jsx)("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"0.1s"}}),(0,s.jsx)("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"0.2s"}})]}),(0,s.jsx)("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Gemini is typing..."})]})})})}),(0,s.jsx)("div",{ref:o})]}),d&&(0,s.jsx)("button",{onClick:u,className:"absolute bottom-4 right-4 bg-blue-600 hover:bg-blue-700 text-white rounded-full w-10 h-10 flex items-center justify-center shadow-lg transition-colors cursor-pointer",children:(0,s.jsx)("i",{className:"ri-arrow-down-line"})})]}):(0,s.jsx)("div",{className:"flex-1 flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("i",{className:"ri-chat-3-line text-6xl text-gray-300 dark:text-gray-600 mb-4"}),(0,s.jsx)("p",{className:"text-gray-500 dark:text-gray-400 text-lg",children:"Start a conversation with Gemini"}),(0,s.jsx)("p",{className:"text-gray-400 dark:text-gray-500 text-sm mt-2",children:"Send a message to begin chatting"})]})})}function E(e){let{onSendMessage:t,disabled:r}=e,[l,n]=(0,a.useState)(""),[i,o]=(0,a.useState)(!1),c=(0,a.useRef)(null),d=(0,a.useRef)(null),m=(0,a.useCallback)(e=>{e.preventDefault(),l.trim()&&!r&&(t(l.trim(),"text"),n(""),d.current&&(d.current.style.height="auto"))},[l,r,t]),u=async e=>{var r;let s=null==(r=e.target.files)?void 0:r[0];if(s){if(!s.type.startsWith("image/"))return void j.Ay.error("Please select an image file");if(s.size>5242880)return void j.Ay.error("Image size must be less than 5MB");o(!0);try{let e=new FileReader;e.onload=e=>{var r;let s=null==(r=e.target)?void 0:r.result;t("","image",s),o(!1),j.Ay.success("Image uploaded successfully")},e.readAsDataURL(s)}catch(e){o(!1),j.Ay.error("Failed to upload image")}c.current&&(c.current.value="")}};return(0,s.jsx)("div",{className:"border-t border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 p-4",children:(0,s.jsxs)("form",{onSubmit:m,className:"flex items-end space-x-3",children:[(0,s.jsxs)("div",{className:"flex space-x-2",children:[(0,s.jsx)("button",{type:"button",onClick:()=>{var e;return null==(e=c.current)?void 0:e.click()},disabled:r||i,className:"flex items-center justify-center w-10 h-10 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 transition-colors cursor-pointer disabled:opacity-50",title:"Upload image",children:i?(0,s.jsx)("div",{className:"w-4 h-4 animate-spin rounded-full border-2 border-transparent border-t-current"}):(0,s.jsx)("i",{className:"ri-image-line text-xl"})}),(0,s.jsx)("input",{ref:c,type:"file",accept:"image/*",onChange:u,className:"hidden"})]}),(0,s.jsx)("div",{className:"flex-1 relative",children:(0,s.jsx)("textarea",{ref:d,value:l,onChange:e=>{n(e.target.value);let t=e.target;t.style.height="auto",t.style.height=Math.min(t.scrollHeight,120)+"px"},onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),m(e))},placeholder:"Message Gemini...",disabled:r,rows:1,className:"w-full resize-none rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 px-4 py-3 pr-12 text-sm text-gray-900 dark:text-gray-100 placeholder:text-gray-500 dark:placeholder:text-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:opacity-50 disabled:cursor-not-allowed",style:{minHeight:"48px",maxHeight:"120px"}})}),(0,s.jsx)(p,{type:"submit",disabled:!l.trim()||r,className:"w-10 h-10 p-0 flex items-center justify-center",children:(0,s.jsx)("i",{className:"ri-send-plane-fill text-lg"})})]})})}function M(e){let{isOpen:t,onClose:r,title:l,children:n,className:i}=e;return((0,a.useEffect)(()=>{let e=e=>{"Escape"===e.key&&r()};return t&&(document.addEventListener("keydown",e),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",e),document.body.style.overflow="unset"}},[t,r]),t)?(0,s.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[(0,s.jsx)("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:r}),(0,s.jsxs)("div",{className:h("relative bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full mx-4 max-h-[90vh] overflow-y-auto",i),children:[l&&(0,s.jsxs)("div",{className:"px-6 py-4 border-b border-gray-200 dark:border-gray-700",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:l}),(0,s.jsx)("button",{onClick:r,className:"absolute top-4 right-4 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:(0,s.jsx)("i",{className:"ri-close-line text-xl"})})]}),(0,s.jsx)("div",{className:"p-6",children:n})]})]}):null}function O(e){var t;let{isOpen:r,onClose:a,onCreateChatroom:l}=e,{register:n,handleSubmit:i,formState:{errors:d},reset:m}=(0,o.mN)({resolver:(0,c.u)(x)}),u=()=>{m(),a()};return(0,s.jsx)(M,{isOpen:r,onClose:u,title:"Create New Chat",children:(0,s.jsxs)("form",{onSubmit:i(e=>{l(e.title),m(),a()}),className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Chat Title"}),(0,s.jsx)(b,{...n("title"),placeholder:"Enter chat title...",error:null==(t=d.title)?void 0:t.message,autoFocus:!0})]}),(0,s.jsxs)("div",{className:"flex justify-end space-x-3 pt-4",children:[(0,s.jsx)(p,{type:"button",variant:"secondary",onClick:u,children:"Cancel"}),(0,s.jsx)(p,{type:"submit",children:"Create Chat"})]})]})})}function I(){return(0,s.jsx)(j.l$,{position:"top-right",toastOptions:{duration:4e3,style:{background:"var(--toast-bg)",color:"var(--toast-color)",border:"1px solid var(--toast-border)"},success:{iconTheme:{primary:"#10B981",secondary:"#FFFFFF"}},error:{iconTheme:{primary:"#EF4444",secondary:"#FFFFFF"}}}})}let A=["I'm here to help! What would you like to know?","That's an interesting question. Let me think about that...","I understand what you're asking. Here's my perspective:","Thanks for sharing that with me. I find that quite fascinating.","I'm processing your request. Give me a moment to provide a thoughtful response.","That's a great point! I'd like to explore that idea further.","I appreciate you bringing this up. Let me share some insights:","Your question touches on something important. Here's what I think:"];function P(){let{user:e,isLoading:t,login:r}=i(),{theme:l}=function(){let[e,t]=(0,a.useState)("light");return(0,a.useEffect)(()=>{let e=n.getTheme();t(e),document.documentElement.classList.toggle("dark","dark"===e)},[]),{theme:e,toggleTheme:()=>{let r="light"===e?"dark":"light";t(r),n.setTheme(r),document.documentElement.classList.toggle("dark","dark"===r)}}}(),[o,c]=(0,a.useState)("phone"),[d,m]=(0,a.useState)({phone:"",countryCode:""}),[u,x]=(0,a.useState)([]),[g,h]=(0,a.useState)(null),[f,p]=(0,a.useState)(!1),[b,k]=(0,a.useState)(!1),[w,M]=(0,a.useState)({}),[P,L]=(0,a.useState)(!1),[F,R]=(0,a.useState)(!1);(0,a.useEffect)(()=>{R(!0)},[]),(0,a.useEffect)(()=>{if(e&&F){let e=n.getChatrooms();x(e),e.length>0&&!g&&h(e[0].id)}},[e,g,F]),(0,a.useEffect)(()=>{e&&u.length>0&&F&&n.setChatrooms(u)},[u,e,F]);let U=(0,a.useCallback)((e,t)=>{let r=[],s=20*t;for(let e=0;e<20;e++){let t=s+e,a=Math.random()>.5,l=new Date;l.setHours(l.getHours()-t),r.push({id:y(),content:a?"User message ".concat(t+1):A[Math.floor(Math.random()*A.length)],sender:a?"user":"ai",timestamp:l,type:"text"})}return r.reverse()},[]),D=(0,a.useMemo)(()=>{var e;let t;return e=(e,t)=>{p(!0),setTimeout(()=>{let t={id:y(),content:A[Math.floor(Math.random()*A.length)],sender:"ai",timestamp:new Date,type:"text"};x(r=>r.map(r=>r.id===e?{...r,messages:[...r.messages,t],lastMessage:t}:r)),p(!1),j.Ay.success("New message from Gemini")},1500+2e3*Math.random())},function(){for(var r=arguments.length,s=Array(r),a=0;a<r;a++)s[a]=arguments[a];t||(e(...s),t=!0,setTimeout(()=>t=!1,3e3))}},[]);if(t||!F)return(0,s.jsx)("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 flex items-center justify-center",children:(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("div",{className:"w-8 h-8 animate-spin rounded-full border-4 border-transparent border-t-blue-600"}),(0,s.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:"Loading..."})]})});if(!e)return(0,s.jsxs)("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 flex items-center justify-center p-4",children:[(0,s.jsx)(I,{}),"phone"===o?(0,s.jsx)(v,{onOtpSent:(e,t)=>{m({phone:e,countryCode:t}),c("otp")}}):(0,s.jsx)(N,{phone:d.phone,countryCode:d.countryCode,onVerify:()=>{r({id:y(),phone:d.phone,countryCode:d.countryCode,isAuthenticated:!0}),j.Ay.success("Welcome to Gemini Chat!")},onBack:()=>c("phone")})]});let H=u.find(e=>e.id===g);return(0,s.jsxs)("div",{className:"h-screen bg-gray-50 dark:bg-gray-900 flex flex-col",children:[(0,s.jsx)(I,{}),(0,s.jsx)(C,{}),(0,s.jsxs)("div",{className:"flex-1 flex overflow-hidden",children:[(0,s.jsx)(S,{chatrooms:u,currentChatroom:g,onSelectChatroom:h,onDeleteChatroom:e=>{if(x(t=>t.filter(t=>t.id!==e)),g===e){let t=u.filter(t=>t.id!==e);h(t.length>0?t[0].id:null)}j.Ay.success("Chat deleted successfully!")},onCreateChatroom:()=>k(!0)}),(0,s.jsx)("div",{className:"flex-1 flex flex-col",children:H?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"border-b border-gray-200 dark:border-gray-700 p-4 bg-white dark:bg-gray-800",children:(0,s.jsx)("h2",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:H.title})}),(0,s.jsx)(T,{messages:H.messages,isTyping:f,onLoadMore:()=>{if(!g||P)return;L(!0);let e=(w[g]||0)+1;setTimeout(()=>{let t=U(g,e);x(e=>e.map(e=>e.id===g?{...e,messages:[...t,...e.messages]}:e)),M(t=>({...t,[g]:e})),L(!1)},1e3)},hasMore:!0,isLoading:P}),(0,s.jsx)(E,{onSendMessage:(e,t,r)=>{if(!g)return;let s={id:y(),content:e,sender:"user",timestamp:new Date,type:t,imageUrl:r};x(e=>e.map(e=>e.id===g?{...e,messages:[...e.messages,s],lastMessage:s}:e)),"text"===t&&D(g,e),j.Ay.success("Message sent!")},disabled:f})]}):(0,s.jsx)("div",{className:"flex-1 flex items-center justify-center bg-white dark:bg-gray-800",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("i",{className:"ri-chat-3-line text-6xl text-gray-300 dark:text-gray-600 mb-4"}),(0,s.jsx)("p",{className:"text-gray-500 dark:text-gray-400 text-lg mb-4",children:"Select a chat to start messaging"}),(0,s.jsx)("button",{onClick:()=>k(!0),className:"text-blue-600 dark:text-blue-400 hover:underline cursor-pointer",children:"Create your first chat"})]})})})]}),(0,s.jsx)(O,{isOpen:b,onClose:()=>k(!1),onCreateChatroom:e=>{let t={id:y(),title:e,messages:[],createdAt:new Date};x(e=>[t,...e]),h(t.id),j.Ay.success("Chat created successfully!")}})]})}},7362:(e,t,r)=>{Promise.resolve().then(r.bind(r,2887))}},e=>{var t=t=>e(e.s=t);e.O(0,[482,441,684,358],()=>t(7362)),_N_E=e.O()}]);